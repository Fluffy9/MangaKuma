    <script src="/js/elasticlunr.min.js"></script>
	<script>
	var all = [];
	var store = {
		store: {}
	};

	$.getJSON( "/index.json", function( data ) {
		var idx = elasticlunr(function () {
			this.addField('name');
			this.addField('tags');
			this.setRef('href');
		});
		data.forEach(function(item) {
			var doc = {
				'name': item.name,
				'tags': item.tags,
				'href': item.ref,
				'thumb': item.thumb,
				'pages': item.pages
				};

			store.store[doc.href] = doc;
			idx.addDoc(doc);
		});
		/*var idx = lunr(function() {
			this.field('name', {
				boost: 40
			});
			this.field('tags', {
				boost: 40
			});
			
			this.ref('href');
			
			// This is the file generated by Hugo.
			var source = data;

			var that = this;

			source.forEach(function(item) {
				var doc = {
					'name': item.name,
					'tags': item.tags,
					'href': item.ref,
					'thumb': item.thumb,
					'pages': item.pages
					};

				store.store[doc.href] = doc;
				that.add(doc);
			});

		});/*
			var source = data;

			var that = this;

			source.forEach(function(item) {
				var doc = {
					'name': item.name,
					'tags': item.tags,
					'href': item.ref
				};

				store.store[doc.href] = item.name
				index.addDoc(doc);
			});*/
		store.index = idx
		//store.index = index;
		
		var serialized = JSON.stringify(store)
	
	});
	function display_search_results(results){
	var $search_results = $("#search-results");
	$search_results.html("");
	template = '<div class="row text-center text-lg-left imagecontainer">'+
				'<div class="tab-content">'+
					'<div id="menu1" class="tab-pane in active">'+
					'</div>'+
				'<div id="home" class="tab-pane fade">'+
					'<div id="crjt" class="row">'+
					'</div>'+
				'</div>'+
			'</div>'+
		'</div>';
	$search_results.append(template);
		$("#results").remove();
		$("#pagination").remove();
	$search_results.show();
	// Are there any results?
      if (results.length) {
        $search_results.find("#menu1").empty(); // Clear any old results
        $search_results.find("#crjt").empty(); // Clear any old results
		

        // Iterate over the results
        results.forEach(function(result) {
          var item = store.store[result.ref];//result.ref;
		  var image = "https://hentaku.sfo2.cdn.digitaloceanspaces.com/" + item.thumb.replace("/manga/","")
		  var image = "http" + image.substring(image.lastIndexOf("."), image.length - image.lastIndexOf(".")) + ".jpg";
          // Build a snippet of HTML for this result
          

          // Add the snippet to the collection of results.
          $search_results.find("#menu1")[0].innerHTML += MakeList(result.ref,image,item.name,item.pages,item.tags);
		  var image = "https://hentaku.sfo2.cdn.digitaloceanspaces.com/" + item.thumb.replace("/manga/","")
		  var image = "http" + image.substring(image.lastIndexOf("."), image.length - image.lastIndexOf(".")) + ".jpg";
          $search_results.find("#crjt")[0].innerHTML += MakeThumb(result.ref,image,item.name);
		  
		  
        });
      } else {
        // If there are no results, let the user know.
        $search_results.find("#menu1")[0].innerHTML = '<li>No results found.<br/>Please check spelling, spacing, etc...</li>';
	    $search_results.find("#crjt")[0].innerHTML += '<li>No results found.<br/>Please check spelling, spacing, etc...</li>';

      }
	}
	function MakeList(Permalink,Thumb,Title,Pages,Tags){
		return '<div class="element right-caption row ">'+
			'<div class="thumbnail span4 col-4">'+
				'<a href="' + Permalink +'">'+
					  '<img id="post-thumbnail" class="img-responsive responsive--full" src='+Thumb+' alt="http://via.placeholder.com/350x150" style="max-width:100%; max-height:100%">'+
				'</a>'+
			'</div>'+
			'<div class="caption col-8">'+
				'<h5 class="title" style="">'+
					Title +
				'</h5>'+
				'</br>'+
				'<p>Pages: </span>'+Pages+'</span></p>'+
				'<p>Tags: </span>'+ (Tags.length > 5 ? (createTag(Tags[0]) + createTag(Tags[1]) + createTag(Tags[3]) + createTag(Tags[4])) : createTag(Tags)) +'</span></p>'+
				'<div class="post-meta">'+								
				'</div>'+
				'<div class="the-content">'+
				'</div>'+
				'<div class="meta clearfix">'+
					'<div class="category"></div>'+
					'<div class="tags"></div>'+
				'</div>'+
			'</div>'+
			'</div>';
	}
	function MakeThumb(Permalink,Thumb,Title){
		return '<div class="col-lg-4 col-xs-8" >'+
		'<div class="thumbnail">'+
			'<a href="'+Permalink+'">'+
			  '<figure >'+
				  '<img id="post-thumbnail" class="img-responsive responsive--full" src="'+Thumb+'" alt="http://via.placeholder.com/350x150">'+
			  '</figure>'+		
			'</a>'+
			'<div class="caption">'+
			'<div class="caption_content">'+
			'<h5 class="title" style="text-align:center;">'+Title+'</h5>'+
			'<div class="post-meta">'+								
			'</div>'+
			'<div class="the-content">'+
			'</div>'+
			'<div class="meta clearfix">'+
				'<div class="category"></div>'+
				'<div class="tags"></div>'+
			'</div>'+
			'</div>'+
			'</div>'+
		'</div>'+
	'</div>';
	}
	letter = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"];
	number = ["1", "2", "3", "4", "5", "6", "7", "8", "8", "7", "6", "5", "4", "3", "2", "1", "1", "2", "3", "4", "5", "6", "7", "8", "8", "7"];
	function createTag(name){
		s = "";
		if(!(typeof name === 'string')){
			for(j = 0; j < name.length; j++){
				v = (number[letter.indexOf((name[j].trim().toUpperCase())[0])]);
				v = v ? v : 7;
				s += '<a class="tag tag'+v+'" title="'+ name[j] +'" href="/tags/'+name[j]+'"> '+name[j]+' </a> ';
			}
		return s;
		}
		v = (number[letter.indexOf((name.trim().toUpperCase()[0]))]);
		v = v ? v : 7;
		return '<a class="tag tag'+v+'" title="'+ name.trim() +'" href="/tags/'+name.trim()+'"> '+name.trim()+' </a> ';
	}

	$(document).ready(function() {
		function SubmitSearch(){
			event.preventDefault();
			var query = $("#searchbar").val(); // Get the value for the text field
			//var results = window.store.index.search(query);// Get elasticlunr to perform a search
			if(!query){return;}
			var results = window.store.index.search(query, {
				fields: {
					name: {boost: 2},
					tags: {boost: 1}
				},
				bool: "OR",
				expand: true
			});
			
			display_search_results(results); // Hand the results off to be displayed
		}
		$("#searchbar").on('keyup', function (e) {
			if (e.keyCode == 13) {
				SubmitSearch();
			}
		});
		$("#searchbutton").click(function(event){
			SubmitSearch();
		});
		
		$("#searchbar").focus(function(){
		  $("#SearchTips").slideToggle(500);
		});
		$("#searchbar").blur(function(){
		  $("#SearchTips").slideToggle(500);
		});

	});
	
	
	
	</script>
	<script>
/*var all = [];
function createManga(title,name, pages, permalink, thumb, date, tags) {
	return {
	Title: title,
	Name: name,
	Pages: pages,
	Permalink: permalink,
	Thumb: thumb,
	Date: new Date(date.substr(0,10)),
	Tags: tags.split(",")
	};
}

function lessPages(obj1, obj2){
	return obj1.Pages - obj2.Pages;
}
function morePages(obj1, obj2){
	return obj2.Pages - obj1.Pages;
}
function ascDate(obj1, obj2){
	return obj1.Date - obj2.Date;
}
function descDate(obj1, obj2){
	return obj2.Date - obj1.Date;
}
letter = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"];
number = ["1", "2", "3", "4", "5", "6", "7", "8", "8", "7", "6", "5", "4", "3", "2", "1", "1", "2", "3", "4", "5", "6", "7", "8", "8", "7"];
function createTag(name){
	s = "";
	if(!(typeof name === 'string')){
		for(j = 0; j < name.length; j++){
			v = (number[letter.indexOf((name[j].trim().toUpperCase())[0])]);
			v = v ? v : 7;
			s += '<a class="tag tag'+v+'" title="'+ name[j] +'" href="/tags/'+name[j]+'"> '+name[j]+' </a> ';
		}
	return s;
	}
	v = (number[letter.indexOf((name.trim().toUpperCase()[0]))]);
	v = v ? v : 7;
	return '<a class="tag tag'+v+'" title="'+ name.trim() +'" href="/tags/'+name.trim()+'"> '+name.trim()+' </a> ';
}

{{range .Site.Taxonomies.manga}}
	{{range .Sections}}
		all[all.length] = createManga("{{.Params.name}}","{{.Name}}",{{len .Pages}}, "{{.Permalink}}", "{{.Params.thumb}}","{{.Date}}","{{ range $i, $e := .Params.tags }}{{ if $i }}, {{ end }}{{ $e }}{{ end }}");
	{{end}}
{{end}}
all.sort(descDate);
/*$( document ).ready(function() {
	$('#Paginator').pagination({
    dataSource: all,
	ulClassName:'pagination bg-dark',
	prevText:'<i class="fas fa-angle-left"></i>',
	nextText:'<i class="fas fa-angle-right"></i>',
    callback: function(data, pagination) {
        // template method of yourself
		$("#menu1").html("");
		for(index = 0; index < data.length; index++){
		(function(i){setTimeout(function(){ 
				Manga = data[i];
				Manga.Title = Manga.Title.length > 50 ? Manga.Title.substr(0, 50)+"...": Manga.Title;
				seriesTemplate='<div class="element right-caption row ">'+
			'<div class="thumbnail span4 col-4">'+
				'<a href="' + Manga.Permalink +'">'+
					  '<img id="post-thumbnail" class="img-responsive responsive--full" src='+Manga.Thumb+' alt="http://via.placeholder.com/350x150" style="max-width:100%; max-height:100%">'+
				'</a>'+
			'</div>'+
			'<div class="caption col-8">'+
				'<h5 class="title" style="">'+
					Manga.Title +
				'</h5>'+
				'</br>'+
				'<p>Pages: </span>'+Manga.Pages+'</span></p>'+
				'<p>Tags: </span>'+ (Manga.Tags.length > 5 ? (createTag(Manga.Tags[0]) + createTag(Manga.Tags[1]) + createTag(Manga.Tags[3]) + createTag(Manga.Tags[4])) : createTag(Manga.Tags)) +'</span></p>'+
				'<div class="post-meta">'+								
				'</div>'+
				'<div class="the-content">'+
				'</div>'+
				'<div class="meta clearfix">'+
					'<div class="category"></div>'+
					'<div class="tags"></div>'+
				'</div>'+
			'</div>'+
			'</div>';
			$("#menu1").append(seriesTemplate);
		},i*200);
		})(index);
		}
    }
});
});
*/
</script>

		<div class="input-group mb-3">
		  <input id="searchbar" type="text" class="form-control btn-secondary" placeholder="Search">
		  <div class="input-group-append">
			<span id="searchbutton" class="input-group-text btn-secondary" id="searchbutton" ><i class="fas fa-search"></i></span>
		  </div>
		</div>
		<div id="SearchTips" class="alert alert-info" style="display:none" role="alert">
		 <span>Advanced Search Tips: </span><br>
		 <span>+ must contain </span><br>
		 <span>- must not contain </span><br>
		 <span>&nbsp;   may contain </span><br>
		 <span>Put a '-' between tags that have multiple words. Space between words means tag1 OR tag2 </span><br>
		</div>
		<div id="searchresults"></div>
